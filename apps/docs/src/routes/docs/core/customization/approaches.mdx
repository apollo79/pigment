import { Alert } from "@kobalte/pigment";

import { Preview, TabsSnippets } from "../../../../components";
import { GithubThemeExample, SlotClassesExample } from "../../../../examples/approaches";

# Approaches

Learn about the different approaches available to customize Pigment components, depending on the situation.

## The `slotClasses` prop

To customizing only a specific instance of a given component, use the `slotClasses` prop.

Supported by every Pigment components, it allows you to apply CSS classes to internal parts (slots) of a component.

<Preview>
  <SlotClassesExample />
</Preview>

```tsx {6-13}
<Alert
  variant="soft"
  status="info"
  isMultiline
  isDismissible
  title="Software update."
  slotClasses={{
    root: "rounded-md bg-blue-50 border-blue-300 w-full max-w-sm dark:bg-blue-900 dark:border-blue-700",
    content: "gap-y-1 text-slate-800 dark:text-slate-100",
    icon: "text-blue-500 text-2xl mt-0.5 dark:text-blue-400",
    title: "text-base font-normal italic",
    description: "text-sm",
    dismissButton: "text-slate-500 text-xl dark:text-slate-400",
  }}
>
  A new software update is available.
</Alert>
```

<Alert>
  <span>To know which slots are available checkout the </span>
  <span>_"Slots"_ section in each component documentation.</span>
</Alert>

## Theming

To ensure every instance of a given component looks the same across you app, use Pigment's theming API.

Theming in Pigment is done in two places:

- **`tailwind.config.cjs`**: define your design tokens such as color schemes, typography, and shadows using the Pigment preset for Tailwind CSS.
- **`ThemeProvider`**: define how each component, and their different variants and states, uses the design tokens.

The example below demonstrate how to reproduce GitHub primary button (in light mode):

<Preview>
  <GithubThemeExample />
</Preview>

<TabsSnippets>
  <TabsSnippets.List>
    <TabsSnippets.Trigger value="index.tsx">index.tsx</TabsSnippets.Trigger>
    <TabsSnippets.Trigger value="tailwind.config.cjs">tailwind.config.cjs</TabsSnippets.Trigger>
  </TabsSnippets.List>
  {/* <!-- prettier-ignore-start --> */}
  <TabsSnippets.Content value="index.tsx">
    ```tsx {4,6-28}
    import { Button, cn, ThemeProvider } from "@kobalte/pigment";

    function App() {
      return (
        <div data-pg-theme="github">
          <ThemeProvider
            components={{
              Button: {
                defaultProps: {
                  variant: "solid",
                  color: "primary",
                  size: "md",
                },
                slotClasses: props => ({
                  root: cn(
                    "font-sans",
                    "rounded-md",
                    "shadow-[0_1px_0_0_rgba(27,31,35,0.04),inset_0_1px_0_rgba(255,255,255,0.03)]",
                    "duration-75",
                    "ease-[cubic-bezier(0.33,1,0.68,1)]",
                    "transition-[color,background-color,box-shadow,border-color]",
                    "font-medium",
                    "text-sm",
                    props.size === "md" && "h-8 px-4",
                    props.variant === "solid" && props.color === "primary" && "border border-solid"
                  ),
                }),
              },
            }}
          >
            <Button>New pull request</Button>
          </ThemeProvider>
        </div>
      );
    }
    ```

  </TabsSnippets.Content>
  <TabsSnippets.Content value="tailwind.config.cjs">
    ```js {0,10-37}
    const pigment = require("@kobalte/pigment-tailwind-preset");

    /** @type {import('tailwindcss').Config} */
    module.exports = {
      content: [
        "./node_modules/@kobalte/pigment/dist/**/*.{js,cjs,mjs}",
        "./src/**/*.{html,js,jsx,ts,tsx,mdx}",
      ],
      theme: {},
      presets: [
        pigment({
          themes: [
            /** @type {import('@kobalte/pigment-tailwind-preset').CustomTheme} */
            {
              name: "github",
              tokens: vars => ({
                common: {
                  typography: {
                    fontFamilySans: vars("typography.fontFamilyFallback"),
                  },
                },
                light: {
                  colors: {
                    solidPrimaryContent: "#ffffff",
                    solidPrimarySurface: "#2da44e",
                    solidPrimaryLine: "#1a1e2326",
                    solidPrimaryContentHover: "#ffffff",
                    solidPrimarySurfaceHover: "#2c974b",
                    solidPrimaryLineHover: "#1b1f2426",
                    solidPrimaryContentActive: "#ffffff",
                    solidPrimarySurfaceActive: "#298e46",
                    solidPrimaryLineActive: "#1b1f2426",
                  },
                },
              }),
            },
          ],
        }),
      ],
    };
    ```

  </TabsSnippets.Content>
  {/* <!-- prettier-ignore-end -->*/}
</TabsSnippets>

### Using a theme

To use a theme (predefined or custom), add it to the Pigment preset in your `tailwind.config.cjs`.

```js {13}
// tailwind.config.cjs

const pigment = require("@kobalte/pigment-tailwind-preset");

/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./node_modules/@kobalte/pigment/dist/**/*.{js,cjs,mjs}",
    "./src/**/*.{html,js,jsx,ts,tsx,mdx}",
  ],
  theme: {},
  presets: [
    pigment({
      themes: ["base"], // `base` is a predefined Pigment theme.
    }),
  ],
};
```

The first theme in the array is applied by default, to apply a specific theme add the `[data-pg-theme]` attribute to any component in your DOM tree, and provide the theme name as value:

```tsx {2,4}
export default function App() {
  return (
    <div data-pg-theme="custom">
      This div will use the "custom" theme.
      <span data-pg-theme="base">This span will use the "base" theme.</span>
    </div>
  );
}
```

<Alert>
  <span>If no theme is provided in the Pigment preset, </span>
  <span>the `base` theme will be used by default.</span>
</Alert>

### Creating a theme

Pigment uses the concept of design tokens to name and store design decisions. A theme is just a named set of design tokens.

To print your own design language into Pigment components, start by customizing these tokens first, as every component uses them.

To do that, create or extend a theme in the Pigment preset of your `tailwind.config.cjs`:

```js
// tailwind.config.cjs

const pigment = require("@kobalte/pigment-tailwind-preset");

/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./node_modules/@kobalte/pigment/dist/**/*.{js,cjs,mjs}",
    "./src/**/*.{html,js,jsx,ts,tsx,mdx}",
  ],
  theme: {},
  presets: [
    pigment({
      themes: [
        /** @type {import('@kobalte/pigment-tailwind-preset').CustomTheme} */
        {
          // The name of your theme, used in the data attribute (ex: `data-pg-theme="my-theme"`).
          name: "my-theme",

          // Extend Pigment "base" theme, or omit to create a theme from scratch.
          extend: "base",

          // Your custom design tokens.
          tokens: vars => ({
            // Color scheme independent tokens.
            common: {
              typography: {
                // use the `vars()` function to pick a value from the theme.
                fontFamilySans: `Inter, ${vars("typography.fontFamilyFallback")}`,
              },
            },
            // Light mode tokens.
            light: {
              colors: {
                primary50: "#eff6ff",
                primary100: "#dbeafe",
                primary200: "#bfdbfe",
                primary300: "#93c5fd",
                primary400: "#60a5fa",
                primary500: "#3b82f6",
                primary600: "#2563eb",
                primary700: "#1d4ed8",
                primary800: "#1e40af",
                primary900: "#1e3a8a",
                //...
              },
            },
            // Dark mode tokens.
            dark: {
              //...
            },
          }),
        },
      ],
    }),
  ],
};
```

Under the hood, the Pigment preset will add the tokens to the Tailwind theme, allowing you to use them in utility classes.

```tsx
<button class="font-sans bg-primary-500">Button</button>
```

{/* <!-- prettier-ignore-start --> */}

<Alert status="warning">
  <span>Colors defined in Pigment themes are not compatible with Tailwind [opacity modifier syntax](https://tailwindcss.com/docs/upgrade-guide#new-opacity-modifier-syntax).</span>
</Alert>
{/* <!-- prettier-ignore-end --> */}

### Custom CSS variables prefix

Each design token of a Pigment theme will generate a CSS variable prefixed with `pg-` by default. If you want to change the prefix to something else, provide the `cssVarPrefix` to the Pigment preset:

```js {13}
// tailwind.config.cjs

const pigment = require("@kobalte/pigment-tailwind-preset");

/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./node_modules/@kobalte/pigment/dist/**/*.{js,cjs,mjs}",
    "./src/**/*.{html,js,jsx,ts,tsx,mdx}",
  ],
  theme: {},
  presets: [
    pigment({
      cssVarPrefix: "app-",
      themes: [
        {
          name: "my-theme",
          extend: "base",
          tokens: vars => ({
            light: {
              colors: {
                primary500: "#3b82f6",
                solidPrimarySurface: vars("colors.primary500"),
              },
            },
          }),
        },
      ],
    }),
  ],
};
```

The generated CSS variables will be:

```css
[data-pg-theme="my-theme"] {
  --app-colors-primary-500: #3b82f6;
  --app-colors-solid-primary-surface: var(--app-colors-primary-500);
}
```

### Customizing components

Each Pigment component uses a pre-defined set of design tokens. To change that while ensuring that every instance has the same styles, do it targeting the component directly from the `ThemeProvider`.

Here's a preview of how you'd change the button's primary background color:

```tsx {5-11}
import { Button, cn, ThemeProvider } from "@kobalte/pigment";

export function App() {
  return (
    <ThemeProvider
      components={{
        Button: {
          slotClasses: props => ({
            root: cn(props.variant === "solid" && props.color === "primary" && "bg-primary-600"),
          }),
        },
      }}
    >
      <Button>Button</Button>
    </ThemeProvider>
  );
}
```

<Alert isMultiline>
  <span>The `cn` utility function, built on top of [clsx](https://github.com/lukeed/clsx) </span>
  <span>and [tailwind-merge](https://github.com/dcastil/tailwind-merge) </span>
  <span>allows you to construct `className` strings conditionally.</span>
</Alert>
